\chapter{Design}
\label{chap:design}

\section{Requirements}
Mjøstaxi's maximum tolerable period of distruption (MTPD) derives from two different components: the administration's need to complete their work during ordinary working hours (08:00 to 16:00 Monday-Friday),
and the IT-System's ability to handle creatings, deletions and updates of orders almost uninterupted.

Mjøstaxi's administration has its core working hours from 08:00 to 16:00, Monday through Friday.
During this time the employees need access to their respective IT resources with relatively low downtime.
The employees report that they can have a single period 30 min downtime and 45 min total downtime during a single day without much hinderance of their work.
It is also reported that they can have downtimes like this 5 times a month, if the downtimes are somewhat evenly distributed.
Based on this info we calculate the MTPD of the administration to be 9.38\% pr day and 2.34\% pr month during ordinary worktime.


The normal operating hours for taxi drivers Sunday to Thursday are 05:00 to 01:00 the next day, and 05:00 to 03:00 the next day on Fridays and Saturdays.
All taxis are connected to a mobile network with 4G routers.
They receive and update information about their orders by using authenticated Application Programming Interface (API) calls that are TLS encrypted.
All card transactions are handled by NETS and the network required to handle this is not our responsibility, neither is the mobile network.
The taxis can store order updates in case of a connection loss so that the taxis can keep operating without mobile network access.
This is mainly intended for areas with low mobile coverage and it has no measure to prevent flooding Mjøstaxi's network if there is prolonged network downtime in HQ.

This means that acceptable downtime is around 14.28\% pr week in order to maintain intended operation.

It is important to note that there is an increased need for uptime during peak hours, mainly Friday and Saturday between 19:00 and 03:00.
A network downtime in this period can result in order creations and order updates backing up and when the network is restored, there can be a flood of traffic that can result in a denial of service.
The network design to be able to handle this potential peak increase in sever traffic.



\section{Solution}



\section{Redundancy}
As many of the company's services are hosted on the servers in the HQ, having a redundant link out to the ISP can be beneficial.
In the case of a network loss, the intranet would be inaccessible from the secondary locations, as well as all rides will have to manually be given out to drivers using the old method of calling the taxis.

This would be most problematic in the peak hours, and during the regular workday when everyone is working in their offices.

\section{Server Hosting}
The company decided on hosting their services in-house, rather than in the cloud.
In the case that the company decides to go with cloud hosting, the infrastructure can mostly remain the same, except removing the demilitarized zone(DMZ) and its supporting infrastructure in the HQ, simplifying the network.

\todo{INSERT DIAGRAM OF CLOUD-SOLUTION, BASICALLY A COPY OF THE ONE WE HAVE, JUST WITHOUT DMZ}


\section{VoIP}
Most employees in the business will receive an IP phone in their office.
To facilitate this in the network design, IP phones have their own VLAN that can access the internet, and further access a VoIP service provider, and Quality of Service(QoS) to ensure proper quality, as VoIP is a real-time service. 
The service provider is a third party telecommunications company that MjøsTaxi will have to sign a deal with.

\section{Tunnelling}
The different sites are connected with tunnels.
To have the network effectively extended to each site, the use of a GRE tunnel, with IPsec security is used.
This approach provides a secure way to transfer data, with high flexibility, allowing the use of protocols like EIGRP.